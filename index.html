<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Convertidor de Playlist</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>body { background-color: #000; color: white; }</style>
</head>
<body class="flex flex-col items-center justify-center min-h-screen p-4">

    <h1 class="text-4xl font-bold mb-8 text-green-500">Spotify a YouTube</h1>

    <div class="w-full max-w-xl flex gap-2 mb-8">
        <input id="urlInput" type="text" placeholder="Pega el link de la playlist aquí..." 
            class="flex-1 p-3 rounded bg-gray-900 border border-gray-700 focus:border-green-500 outline-none">
        <button onclick="buscarCanciones()" id="btn"
            class="bg-green-600 hover:bg-green-700 px-6 rounded font-bold transition">
            Buscar
        </button>
    </div>

    <div id="resultado" class="w-full max-w-xl hidden">
        <h2 class="text-xl mb-4 text-gray-400">Canciones detectadas:</h2>
        <ul id="lista" class="space-y-2"></ul>
    </div>

    <script>
        async function buscarCanciones() {
            const input = document.getElementById('urlInput').value;
            const btn = document.getElementById('btn');
            const lista = document.getElementById('lista');
            const div = document.getElementById('resultado');

            if (!input) return alert("Pega un link primero");

            btn.innerText = "Hackeando...";
            btn.disabled = true;
            lista.innerHTML = "";

            try {
                // Llamamos a TU función "backend" que crearemos en el paso 3
                const resp = await fetch('/api/spotify', {
                    method: 'POST',
                    body: JSON.stringify({ url: input }),
                    headers: { 'Content-Type': 'application/json' }
                });

                const datos = await resp.json();

                if (datos.error) throw new Error(datos.error);

                div.classList.remove('hidden');
                
                datos.forEach(track => {
                    const li = document.createElement('li');
                    li.className = "bg-gray-800 p-3 rounded flex justify-between items-center";
                    li.innerHTML = `
                        <span class="font-bold">${track.titulo}</span>
                        <span class="text-sm text-gray-400">${track.artista}</span>
                    `;
                    lista.appendChild(li);
                });

            } catch (e) {
                alert("Error: " + e.message);
            } finally {
                btn.innerText = "Buscar";
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>